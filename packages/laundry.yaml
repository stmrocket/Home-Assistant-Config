# Sensors
mqtt:
  sensor:
    #Sonoff Washer Monitor
    - name: "Washer State"
      unique_id: cd0ad294-4301-453e-9ac1-e12ae356cca3
      state_topic: "hass/state/washer"
      icon: mdi:washing-machine

    - name: "Washer Watts"
      unique_id: bb9ddd45-b7d4-419c-af44-a588c4cd7454
      state_topic: "tele/SNF-Washer/SENSOR"
      value_template: "{{value_json['ENERGY'].Power }}"
      qos: 2
      unit_of_measurement: "W"
      icon: mdi:flash-circle
      availability_topic: "tele/SNF-Washer/LWT"
      payload_available: "Online"
      payload_not_available: "Offline"

    - name: "Washer Voltage"
      unique_id: 474f8990-0f88-4f0d-9c1a-f35a843a27b9
      state_topic: "tele/SNF-Washer/SENSOR"
      value_template: "{{value_json['ENERGY'].Voltage }}"
      qos: 2
      unit_of_measurement: "V"
      icon: mdi:flash-circle
      availability_topic: "tele/SNF-Washer/LWT"
      payload_available: "Online"
      payload_not_available: "Offline"

    - name: "Washer Amps"
      unique_id: e6254600-b626-4e46-83a0-58f130bb4c3e
      state_topic: "tele/SNF-Washer/SENSOR"
      value_template: "{{value_json['ENERGY'].Current }}"
      qos: 2
      unit_of_measurement: "A"
      icon: mdi:flash-circle
      availability_topic: "tele/SNF-Washer/LWT"
      payload_available: "Online"
      payload_not_available: "Offline"

    - name: "Washer Energy Today"
      unique_id: 4dd28c08-e305-465e-baa9-a9381c53d678
      state_topic: "tele/SNF-Washer/SENSOR"
      value_template: "{{value_json['ENERGY'].Today }}"
      qos: 2
      unit_of_measurement: "kWh"
      availability_topic: "tele/SNF-Washer/LWT"
      payload_available: "Online"
      payload_not_available: "Offline"

    - name: "Washer Energy Yesterday"
      unique_id: bdae31bd-17bf-4e34-b790-1092a06c0268
      state_topic: "tele/SNF-Washer/SENSOR"
      value_template: "{{value_json['ENERGY'].Yesterday }}"
      qos: 2
      unit_of_measurement: "kWh"
      availability_topic: "tele/SNF-Washer/LWT"
      payload_available: "Online"
      payload_not_available: "Offline"

    - state_topic: "tele/SNF-Washer/STATE"
      unique_id: 8410514a-0f33-42aa-8b26-4c174ec40745
      name: "Washer Signal"
      unit_of_measurement: "%"
      value_template: "{{value_json['Wifi'].RSSI }}"
      availability_topic: "tele/SNF-Washer/LWT"
      qos: 1
      payload_available: "Online"
      payload_not_available: "Offline"

    #Sonoff Dryer Monitor
    - name: "Dryer State"
      unique_id: 9e4b07de-7a19-4f99-ad73-3e9cfcfda4de
      state_topic: "hass/state/dryer"
      icon: mdi:tumble-dryer

    - name: "Dryer Watts"
      unique_id: 3b07e690-dbe8-4d5d-8151-9985c7008e86
      state_topic: "tele/SNF-Dryer/SENSOR"
      value_template: "{{value_json['ENERGY'].Power }}"
      qos: 2
      unit_of_measurement: "W"
      icon: mdi:flash-circle
      availability_topic: "tele/SNF-Dryer/LWT"
      payload_available: "Online"
      payload_not_available: "Offline"

    - name: "Dryer Voltage"
      unique_id: d0226e54-93d0-46a8-9606-4a478b4ef0ca
      state_topic: "tele/SNF-Dryer/SENSOR"
      value_template: "{{value_json['ENERGY'].Voltage }}"
      qos: 2
      unit_of_measurement: "V"
      icon: mdi:flash-circle
      availability_topic: "tele/SNF-Dryer/LWT"
      payload_available: "Online"
      payload_not_available: "Offline"

    - name: "Dryer Amps"
      unique_id: fff955d1-c668-490d-814f-70943d09a884
      state_topic: "tele/SNF-Dryer/SENSOR"
      value_template: "{{value_json['ENERGY'].Current }}"
      qos: 2
      unit_of_measurement: "A"
      icon: mdi:flash-circle
      availability_topic: "tele/SNF-Dryer/LWT"
      payload_available: "Online"
      payload_not_available: "Offline"

    - name: "Dryer Energy Today"
      unique_id: 3550eaad-a3df-4a91-83db-b6cbad3e6c80
      state_topic: "tele/SNF-Dryer/SENSOR"
      value_template: "{{value_json['ENERGY'].Today }}"
      qos: 2
      unit_of_measurement: "kWh"
      availability_topic: "tele/SNF-Dryer/LWT"
      payload_available: "Online"
      payload_not_available: "Offline"

    - name: "Dryer Energy Yesterday"
      unique_id: dd6988cb-df90-4540-a971-948a4e927fca
      state_topic: "tele/SNF-Dryer/SENSOR"
      value_template: "{{value_json['ENERGY'].Yesterday }}"
      qos: 2
      unit_of_measurement: "kWh"
      availability_topic: "tele/SNF-Dryer/LWT"
      payload_available: "Online"
      payload_not_available: "Offline"

    - state_topic: "tele/SNF-Dryer/STATE"
      unique_id: eccae6a2-c100-4243-9d14-c060154de4c0
      name: "Dryer Signal"
      unit_of_measurement: "%"
      value_template: "{{value_json['Wifi'].RSSI }}"
      availability_topic: "tele/SNF-Dryer/LWT"
      qos: 1
      payload_available: "Online"
      payload_not_available: "Offline"
      
sensor:
  - platform: template
    sensors:
      washer_status:
        unique_id: de9d8708-c377-40ba-a545-0ddaf5ff11fc
        value_template: >-
          {% if is_state('input_boolean.washer_end', 'on')  -%}
            Done
          {% else -%}
            {{ states('sensor.washer_state')}}
          {% endif -%}

      dryer_status:
        unique_id: 17ca6811-6cac-4a56-93ee-1c2e578d0779
        value_template: >-
          {% if is_state('input_boolean.dryer_end', 'on')  -%}
            Done
          {% else -%}
            {{ states('sensor.dryer_state')}}
          {% endif -%}

input_boolean:
  washer_end:
    name: Washer Finished
    initial: off
    icon: mdi:stop-circle

  dryer_end:
    name: Dryer Finished
    initial: off
    icon: mdi:stop-circle

# Timers
timer:
  washer_alert:
    name: Washer Announcement Timer
    duration: "00:05:00"

  dryer_alert:
    name: Dryer Announcement Timer
    duration: "00:05:00"

#Counters
counter:
  dryer_alert:
    initial: 0
    step: 1
  washer_alert:
    initial: 0
    step: 1
