- alias: Start Roomba from Schedule
  trigger:
    - platform: state
      entity_id: sensor.roomba_scheduler_command
      from: stop
      to: start
  action:
    - service: vacuum.start
      entity_id: vacuum.roomba

- alias: Count Roomba Cycles
  trigger:
    - platform: state
      entity_id: sensor.roomba_status
      to: "cleaning"
  action:
    - service: counter.increment
      entity_id: counter.roomba_cycles

- alias: Roomba Return if House Disarmed
  trigger:
    - entity_id: alarm_control_panel.house
      platform: state
      to: disarmed
  condition:
    - condition: state
      entity_id: sensor.roomba_status
      state: cleaning
    - condition: state
      entity_id: input_boolean.roomba_auto
      state: "on"
  action:
    - service: script.turn_on
      entity_id: script.roomba_dock

- alias: Reset Dust Bin From NFC
  trigger:
    - platform: event
      event_type: tag_scanned
      event_data:
        tag_id: !secret roomba_nfc
  action:
    - service: script.reset_roomba_counter
